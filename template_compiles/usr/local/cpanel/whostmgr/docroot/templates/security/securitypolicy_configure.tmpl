Template::Document->new({METADATA=>{'modtime'=>'1728930269','name'=>'/usr/local/cpanel/whostmgr/docroot/templates/security/securitypolicy_configure.tmpl',},BLOCK=>sub {my$context=shift || die "template sub called without context\n";my$stash=$context->stash;my$output='';my$_tt_error;eval {BLOCK: {$stash->set('CPList',$context->plugin('CPList'));$stash->set('JSON',$context->plugin('JSON'));$stash->set('bgimg',$stash->get(['MagicRevision',['/yui/slider/assets/bg-fader.gif' ]]));$output .= do {my$output='';$output .= '
<script type="text/javascript" src="';$output .= $stash->get(['MagicRevision',['/yui-gen/utilities_json/utilities_json.js' ]]);$output .= '"></script>
<script type="text/javascript" src="';$output .= $stash->get(['MagicRevision',['/yui/slider/slider.js' ]]);$output .= '"></script>
<br />
<p class="description">';$output .= $stash->get(['locale',0,'maketext',['This interface provides the configuration settings of the Security Policy that apply to cPanel, cPanel webmail, and WHM on your server.' ]]);$output .= '</p>
';$stash->set('slider_fields',[]);do {my ($_tt_value,$_tt_error,$_tt_oldloop);my$_tt_list=$stash->get(['data',0,'error',0]);unless (UNIVERSAL::isa($_tt_list,'Template::Iterator')){$_tt_list=Template::Config->iterator($_tt_list)|| die$Template::Config::ERROR,"\n"}($_tt_value,$_tt_error)=$_tt_list->get_first();eval {$_tt_oldloop=$stash->get('loop')};$stash->set('loop',$_tt_list);eval {FOR1: while (!$_tt_error){$stash->{'err'}=$_tt_value;$output .= '<div class="error">';$output .= $stash->get('err');$output .= '</div>
';;($_tt_value,$_tt_error)=$_tt_list->get_next()}};$stash->set('loop',$_tt_oldloop);die $@ if $@;$_tt_error=0 if$_tt_error && $_tt_error eq Template::Constants::STATUS_DONE;die$_tt_error if$_tt_error};if ($stash->get(['data',0,'status',0])){$output .= ' <div class="status">';$output .= $stash->get(['data',0,'status',0]);$output .= '</div>'}$output .= '<div id="content">
	<form name="securityform" id="securityform">

		<div id="policies" class="form_action">
			<fieldset>
				<legend>';$output .= $stash->get(['locale',0,'maketext',['Security Policy Items' ]]);$output .= '</legend>
				<ul>';do {my ($_tt_value,$_tt_error,$_tt_oldloop);my$_tt_list=$stash->get(['data',0,'policies',0]);unless (UNIVERSAL::isa($_tt_list,'Template::Iterator')){$_tt_list=Template::Config->iterator($_tt_list)|| die$Template::Config::ERROR,"\n"}($_tt_value,$_tt_error)=$_tt_list->get_first();eval {$_tt_oldloop=$stash->get('loop')};$stash->set('loop',$_tt_list);eval {FOR1: while (!$_tt_error){$stash->{'p'}=$_tt_value;$output .= '
					<li>
						<input type="checkbox" name="';$output .= $stash->get(['p',0,'key',0]);$output .= '" value="1" id="';$output .= $stash->get(['p',0,'key',0]);$output .= '" ';if ($stash->get(['p',0,'enabled',0])){$output .= 'checked="checked" '}$output .= '/>
						<label for="';$output .= $stash->get(['p',0,'key',0]);$output .= '">';$output .= $stash->get(['p',0,'label',0]);$output .= '</label>
';do {my ($_tt_value,$_tt_error,$_tt_oldloop);my$_tt_list=$stash->get(['p',0,'fields',0]);unless (UNIVERSAL::isa($_tt_list,'Template::Iterator')){$_tt_list=Template::Config->iterator($_tt_list)|| die$Template::Config::ERROR,"\n"}($_tt_value,$_tt_error)=$_tt_list->get_first();eval {$_tt_oldloop=$stash->get('loop')};$stash->set('loop',$_tt_list);eval {FOR2: while (!$_tt_error){$stash->{'field'}=$_tt_value;$stash->set('is_slider',$stash->get(['field',0,'type',0])eq 'slider');$stash->set('html_style',$stash->get(['p',0,'enabled',0])? '' : $stash->get('is_slider')? ' style="position:absolute;visibility:hidden"' : ' style="display:none"');$output .= '						<div id="';$output .= $stash->get(['p',0,'key',0]);$output .= '-config" class="config config_container"';$output .= $stash->get('html_style');$output .= '>
';do {my$_tt_result=$stash->get(['field',0,'type',0]);my$_tt_match;SWITCH: {$_tt_match='slider';$_tt_match=[$_tt_match ]unless ref$_tt_match eq 'ARRAY';if (grep(/^\Q$_tt_result\E$/,@$_tt_match)){$output .= $stash->get(['slider_fields',0,'push',[$stash->get('field')]]);$output .= '                            <label for="';$output .= $stash->get(['field',0,'id',0]);$output .= '">';$output .= $stash->get(['field',0,'label',0]);$output .= '</label>
                                <input id="';$output .= $stash->get(['field',0,'id',0]);$output .= '" name="';$output .= $stash->get(['field',0,'id',0]);$output .= '" type="text" autofill="off" autocomplete="off" size="5" maxlength="5" value="';$output .= $stash->get(['field',0,'value',0]);$output .= '" />
                            <div class="slider-bg" id="';$output .= $stash->get(['field',0,'id',0]);$output .= '-slider-bg" tabindex="-1" title="Slider">
                                <div class="slider-thumb" id="';$output .= $stash->get(['field',0,'id',0]);$output .= '-slider-thumb"><img src="';$output .= $stash->get(['MagicRevision',['/yui/slider/assets/thumb-n.gif' ]]);$output .= '" /></div>
                            </div>
';last SWITCH}$_tt_match='msg';$_tt_match=[$_tt_match ]unless ref$_tt_match eq 'ARRAY';if (grep(/^\Q$_tt_result\E$/,@$_tt_match)){$output .= '                            <p';if ($stash->get(['field',0,'class',0])){$output .= ' class="';$output .= $stash->get(['field',0,'class',0]);$output .= '"'}$output .= '>';$output .= $stash->get(['field',0,'text',0]);$output .= '</p>
';last SWITCH}$output .= '							<label for="';$output .= $stash->get(['field',0,'id',0]);$output .= '">';$output .= $stash->get(['field',0,'label',0]);$output .= '</label>
							<input type="text" name="';$output .= $stash->get(['field',0,'id',0]);$output .= '" id="';$output .= $stash->get(['field',0,'id',0]);$output .= '" maxlength = "4" value="';$output .= $stash->get(['field',0,'value',0]);$output .= '" size="3" /> <span style="display:inline;border:0" class="no_panel" id="';$output .= $stash->get(['field',0,'id',0]);$output .= '_error"></span>
'}};$output .= '						</div>
';;($_tt_value,$_tt_error)=$_tt_list->get_next()}};$stash->set('loop',$_tt_oldloop);die $@ if $@;$_tt_error=0 if$_tt_error && $_tt_error eq Template::Constants::STATUS_DONE;die$_tt_error if$_tt_error};$output .= '					</li>
';;($_tt_value,$_tt_error)=$_tt_list->get_next()}};$stash->set('loop',$_tt_oldloop);die $@ if $@;$_tt_error=0 if$_tt_error && $_tt_error eq Template::Constants::STATUS_DONE;die$_tt_error if$_tt_error};$output .= '			</fieldset>
			</div>
		<div id="options" class="form_action">
			<fieldset>
				<legend>';$output .= $stash->get(['locale',0,'maketext',['Security Policy Extensions' ]]);$output .= '</legend>
                <p class="description">';$output .= $stash->get(['locale',0,'maketext',['In addition to cPanel, cPanel webmail, and WHM interfaces, enable Security Policies for the following request types:' ]]);$output .= '</p>
				<ul>
					<li>
						<input type="checkbox" name="secpol_xml" value="1" id="secpol_xml" ';if ($stash->get(['data',0,'secpol_xml',0])){$output .= 'checked="checked" '}$output .= '/>
						<label for="secpol_xml">';$output .= $stash->get(['locale',0,'maketext',['API requests' ]]);$output .= '</label>
					</li>
					<li>
						<input type="checkbox" name="secpol_dns" value="1" id="secpol_dns" ';if ($stash->get(['data',0,'secpol_dns',0])){$output .= 'checked="checked" '}$output .= '/>
						<label for="secpol_dns">';$output .= $stash->get(['locale',0,'maketext',['DNS Cluster Requests' ]]);$output .= '</label>
					</li>
				</ul>
				<p class="warning">';$output .= $stash->get(['locale',0,'maketext',['Warning: When you enable the Security Policy Extensions for the remote APIs and DNS cluster requests, incompatibilities will become difficult to diagnose. We recommend you do not enable these extensions unless you have an in-depth understanding of your remote API usage and DNS cluster configuration.' ]]);$output .= '</p>
			</fieldset>
			</div>
		<p class="description">';$output .= $stash->get(['locale',0,'maketext',['You may need to reset your password or provide other information immediately after you click Save.' ]]);$output .= "</p>\n\n		<input id=\"cmd\" class=\"btn-primary\" name=\"cmd\" type=\"submit\" value=\"Save\" />\n	</form>\n</div>\n<script type=\"text/javascript\">\nfunction init_slider(field) {\n    var bg        = field.id+\"-slider-bg\",\n        thumb     = field.id+\"-slider-thumb\",\n        valuearea = field.id+\"-slider-value\",\n        textfield = field.id\n    ;\n\n    var bottomConstraint = 200;\n    var maxval = field.maxval || 100;\n    var minval = field.minval || 0;\n    var scaleFactor = (maxval/bottomConstraint);\n    var topConstraint = 0 - (minval/scaleFactor);\n    var keyIncrement = 5;\n    var tickSize = 10;\n\n    var slider = YAHOO.widget.Slider.getHorizSlider(bg,\n        thumb, topConstraint, bottomConstraint, tickSize);\n\n    slider.getRealValue = function() {\n        var thisVal = this.getValue();\n        return Math.round(thisVal*scaleFactor);\n    }\n\n    var textfieldEl = DOM.get(textfield);\n\n    var fix_text_field = function(e) {\n        var v = parseInt( textfieldEl.value.trim() );\n        if ( isNaN(v) ) {\n            textfieldEl.value = textfieldEl.defaultValue || minval;\n            return false;\n        }\n\n        if (v > maxval) {\n            v = maxval;\n        }\n        else if (v < minval) {\n            v = minval;\n        }\n        else {\n            v = keyIncrement * Math.round(v/keyIncrement);\n        }\n\n        textfieldEl.value = v;\n        return v;\n    };\n\n    EVENT.on(textfield,'keyup', function(e) {\n        var v = fix_text_field();\n        if (v !== false) {\n            slider.setValue(Math.round(v/scaleFactor),true);\n        }\n    });\n\n    var initial_value = Number(textfieldEl.value);\n    var fixed_value = fix_text_field();\n    if (fixed_value != initial_value) {\n        textfieldEl.defaultValue = fixed_value;\n    }\n\n    var containing_div = DOM.getAncestorBy(\n        slider.getEl(),\n        function(el) { return( el.id && /-config\$/.test(el.id) ) }\n    );\n    if ( containing_div.style.visibility === \"hidden\" ) {\n        //Slider defers the initial value setting internally.\n        slider.subscribe(\"slideEnd\", function slide_end() {\n            containing_div.style.display = \"none\";\n            containing_div.style.position = \"\";\n            containing_div.style.visibility = \"\";\n            slider.unsubscribe(\"slideEnd\", slide_end);\n        });\n    }\n\n    var hv = parseFloat(textfieldEl.value, 10);\n    slider.setValue(Math.round(hv/scaleFactor),true);\n\n    slider.subscribe(\"change\", function(offsetFromStart) {\n        var fld = DOM.get(textfield);\n        var actualValue = slider.getRealValue();\n        if (actualValue < minval) {\n            actualValue = minval;\n        }\n        fld.value = actualValue;\n        DOM.get(bg).title = field.label + \" = \" + actualValue;\n    });\n};\n\n";$output .= $stash->get(['slider_fields',0,'json',0]);$output .= '.forEach(init_slider);

// Get a list of all the config divs on the page
var checkbox_ids = ';$output .= $stash->get(['data',0,'policies',0,'ofeach',['key' ],'json',0]);$output .= ";\nvar cur_id;\nfor (var i=0; cur_id = checkbox_ids[i]; i++) {\n\n    // Setup an onclick event that toggles the visibility\n    YAHOO.util.Event.on(cur_id, \"click\", function(e) {\n        var config_div = DOM.get( this.id+\"-config\" );\n        if ( !config_div ) return;\n\n        if ( this.checked ) {\n            validation.verify();\n            CPANEL.animate.slide_down( config_div );\n        }\n        else {\n            var slide = CPANEL.animate.slide_up( config_div );\n            slide.onComplete.subscribe( validation.verify, validation, true );\n        }\n    } );\n}\n\nvar validate_max_age = function() {\n    // If the Password Age checkbox is unchecked then no validation required.\n    if ( ! document.getElementById('PasswordAge').checked ) return true;\n\n    var field_value = document.getElementById('maxage').value;\n\n    // re= if there's any characters other than 0123456789 return false\n    if ( ! /^[0-9]{1,5}\$/.test(field_value) ) return false;\n    if ( ( field_value < 1 ) || ( field_value > 1095 ) ) return false;\n    return true;\n}\n\n// Attach light validation to the maxage input field\nvar validation = new CPANEL.validate.validator(\"Security Policy\");\nvalidation.add(\"maxage\", validate_max_age, \"Password age must be a number greater than zero and less than 1095 (3 years)\");\nvalidation.attach();\nvalidation.verify();\n\nCPANEL.validate.attach_to_form(\"cmd\", validation);\n</script>\n";$context->include('master_templates/master.tmpl',{'theme'=>'yui','app_key'=>'configure_security_policies','extrastyle'=>('

.form_action {
	border:8px solid #ddd;
	margin:5px 0 20px;
	width:600px;
}

.config {
    margin: 0 0 0 25px;
}

ul, ol {
    list-style: none;
}
#content fieldset ul, #content fieldset ol, #content fieldset ul li {
    margin: 0;
    padding: 0;
    border: 0;
    border-top: 0;
}

/* Security Form
----------------------------------------------------------------------------------------------------*/
form#securityform span {
	border:1px solid #aaa;
	display: block;
}
form#securityform fieldset {
	border: 0 none;
	margin:0;
	padding:10px 15px;
}
form#securityform legend {
	color:#4C5355;
	font-size:12px;
	font-weight: bold;
	margin: 0;
	padding: 10px 0 0;
}
.slider-bg {
    position: relative;
    background:url(' .$stash->get('bgimg').') 5px 0 no-repeat;
    height:28px;
    width:228px;
}
.slider-thumb {
    cursor:default;
    position: absolute;
    top: 4px;
}
.warning{color:#ff0000; font-weight:bold;}
.status { margin-left: 1em; color: #888; }
.error  { margin-left: 1em; color: #f00; }
'),'content',$output })}}};if ($@){$_tt_error=$context->catch($@,\$output);die$_tt_error unless$_tt_error->type eq 'return'}return$output},DEFBLOCKS=>{},});